CPU2908
====

Open source home brew 8-bit CPU.
----
CPU2908は、74HCシリーズ標準ロジックとROMで作る8ビットCPUです。
コンパクトな基板で低コストで生産出来るように、FPGAにもインプリメントしてあります。
ターゲットデバイスはLattice MachXO2-1200HC、又は2000HCです。
FPGA版は既にプロトタイプ基版まで出来ているので、不具合を修正してリリース版を作ります。

アーキテクチャ
----
- 8ビットCPU、リトルエンディアン
- 4つの汎用8ビットレジスタ。2つまとめて16ビットレジスタとして使う命令あり
- 4つの16ビットアドレスレジスタ。うち1つはスタックポインタ、1つはプログラムカウンタ
- 命令は8ビット長＋イミディエイト値1～2バイト
- μCode方式
- ロード／ストア命令、データ移動命令、算術／論理演算、条件ジャンプ、CALL／RET命令などをサポート
- CALL/JUMP命令は8/16ビットオフセット(プログラムカウンタ相対)

レジスタ構成
----

### 8ビット汎用レジスタR0～R3。

R1とR0は合わせてW0、R3とR2は合わせてW1と表現します。アドレスレジスタとのデータ転送、INC/DEC命令で16ビットレジスタとして使えます。

### 16ビットアドレスレジスタA0、A1、CP、SP。
アドレスレジスタA0、A1はロード/ストア命令でアドレスを指定するのに使います。
また、汎用16ビットレジスタとのデータ転送、交換などの命令もあります。

SPはスタックポインタです。PUSH/POP命令のアドレスはSPが暗黙で指定されます。

CPはコードポインタです。プログラムカウンタ（PC）とかインストラクションポインタ（IP）などの呼び方がありますが、SPがスタックポインタなので、CPがコードポインタです。

μCode方式
----
CPU2908はμCode方式を採用しています。これは、部品数を減らすためと、コード密度を高くするためです。

回路について
====

回路は
- Logisimのドキュメント CPU2908/Document/CPU2908C.circ
- KiCadの回路図 CPU2908/Schematics/74HC/CPU2908C.sch

の2つで、どちらも同じ回路です。
製作にあたってまずLogisim用の回路とμCODEを作りました。これでシミュレーションをしながら動作の確認をして、それからKiCadの回路図を起こしました。
MachXO2用のファイルもこの回路図を元に、回路図入力で作ってあります。
